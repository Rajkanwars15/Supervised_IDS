[2026-01-31 18:36:11] Reading data from /Users/raj/Supervised_IDS/data/sensornetguard_data.csv...
[2026-01-31 18:36:11] Handling missing values...
[2026-01-31 18:36:11]   Missing values before: 0, after: 0
[2026-01-31 18:36:11] 
Splitting data into train/test sets (80/20)...
[2026-01-31 18:36:12]   Training set: 8000 samples
[2026-01-31 18:36:12]   Test set: 2000 samples
[2026-01-31 18:36:12]   Training class distribution: {0: 7610, 1: 390}
[2026-01-31 18:36:12]   Test class distribution: {0: 1903, 1: 97}
[2026-01-31 18:36:12] 
================================================================================
[2026-01-31 18:36:12] Feature Sanity Checks
[2026-01-31 18:36:12] ================================================================================
[2026-01-31 18:36:12] Checking for constant features (zero variance)...
[2026-01-31 18:36:12] Checking for near-constant features (low variance)...
[2026-01-31 18:36:12] Checking for features with excessive missing values...
[2026-01-31 18:36:12]   No problematic features found. All features retained.
[2026-01-31 18:36:12] 
================================================================================
[2026-01-31 18:36:12] Training Decision Tree Classifier...
[2026-01-31 18:36:12] ================================================================================
[2026-01-31 18:36:12] Tree Parameters:
[2026-01-31 18:36:12]   criterion: gini
[2026-01-31 18:36:12]   splitter: best
[2026-01-31 18:36:12]   max_depth: None
[2026-01-31 18:36:12]   min_samples_split: 2
[2026-01-31 18:36:12]   min_samples_leaf: 1
[2026-01-31 18:36:12]   min_weight_fraction_leaf: 0.0
[2026-01-31 18:36:12]   max_features: None
[2026-01-31 18:36:12]   random_state: 42
[2026-01-31 18:36:12]   max_leaf_nodes: None
[2026-01-31 18:36:12]   min_impurity_decrease: 0.0
[2026-01-31 18:36:12]   class_weight: None
[2026-01-31 18:36:12]   ccp_alpha: 0.0
[2026-01-31 18:36:12] 
Training tree (this may take a while for full convergence)...
[2026-01-31 18:36:12] ✓ Tree training completed!
[2026-01-31 18:36:12]   Tree depth: 7
[2026-01-31 18:36:12]   Number of nodes: 23
[2026-01-31 18:36:12]   Number of leaves: 12
[2026-01-31 18:36:12] 
================================================================================
[2026-01-31 18:36:12] Saving model artifact...
[2026-01-31 18:36:12] ================================================================================
[2026-01-31 18:36:12] ✓ Model saved to: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/models/decision_tree_model_20260131_183611.joblib
[2026-01-31 18:36:12] 
================================================================================
[2026-01-31 18:36:12] Creating tree visualization...
[2026-01-31 18:36:12] ================================================================================
[2026-01-31 18:36:12]   Saved PNG: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/visualizations/tree_visualization_20260131_183611.png
[2026-01-31 18:36:12]   Saved SVG: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/visualizations/tree_visualization_20260131_183611.svg
[2026-01-31 18:36:13]   Saved PDF: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/visualizations/tree_visualization_20260131_183611.pdf
[2026-01-31 18:36:13] ✓ Tree visualization completed!
[2026-01-31 18:36:13]   Note: graphviz not installed, skipping graphviz export
[2026-01-31 18:36:13] 
================================================================================
[2026-01-31 18:36:13] Extracting tree structure and splits...
[2026-01-31 18:36:13] ================================================================================
[2026-01-31 18:36:13] 
Tree Structure (first 100 lines):
[2026-01-31 18:36:13] |--- Error_Rate <= 0.16
|   |--- Energy_Consumption_Rate <= 8.52
|   |   |--- Packet_Drop_Rate <= 3.95
|   |   |   |--- Data_Transmission_Frequency <= 25.83
|   |   |   |   |--- Route_Request_Frequency <= 17.28
|   |   |   |   |   |--- Data_Transmission_Frequency <= 25.14
|   |   |   |   |   |   |--- class: 0
|   |   |   |   |   |--- Data_Transmission_Frequency >  25.14
|   |   |   |   |   |   |--- Route_Request_Frequency <= 13.83
|   |   |   |   |   |   |   |--- class: 0
|   |   |   |   |   |   |--- Route_Request_Frequency >  13.83
|   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |--- Route_Request_Frequency >  17.28
|   |   |   |   |   |--- CPU_Usage <= 58.06
|   |   |   |   |   |   |--- class: 0
|   |   |   |   |   |--- CPU_Usage >  58.06
|   |   |   |   |   |   |--- class: 1
|   |   |   |--- Data_Transmission_Frequency >  25.83
|   |   |   |   |--- class: 1
|   |   |--- Packet_Drop_Rate >  3.95
|   |   |   |--- class: 1
|   |--- Energy_Consumption_Rate >  8.52
|   |   |--- Data_Throughput <= 89.44
|   |   |   |--- class: 1
|   |   |--- Data_Throughput >  89.44
|   |   |   |--- class: 0
|--- Error_Rate >  0.16
|   |--- Data_Throughput <= 75.17
|   |   |--- class: 1
|   |--- Data_Throughput >  75.17
|   |   |--- Data_Transmission_Frequency <= 21.56
|   |   |   |--- class: 0
|   |   |--- Data_Transmission_Frequency >  21.56
|   |   |   |--- class: 1

[2026-01-31 18:36:13] 
Full tree structure saved to: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/logs/tree_structure_20260131_183611.txt
[2026-01-31 18:36:13] 
================================================================================
[2026-01-31 18:36:13] Detailed Split Information:
[2026-01-31 18:36:13] ================================================================================
[2026-01-31 18:36:13] SPLIT: feature='Error_Rate', threshold=0.158483, samples=8000, impurity=0.092747
[2026-01-31 18:36:13]   SPLIT: feature='Energy_Consumption_Rate', threshold=8.524600, samples=7649, impurity=0.012730
[2026-01-31 18:36:13]     SPLIT: feature='Packet_Drop_Rate', threshold=3.954108, samples=7608, impurity=0.002625
[2026-01-31 18:36:13]       SPLIT: feature='Data_Transmission_Frequency', threshold=25.825669, samples=7603, impurity=0.001314
[2026-01-31 18:36:13]         SPLIT: feature='Route_Request_Frequency', threshold=17.278324, samples=7601, impurity=0.000789
[2026-01-31 18:36:13]           SPLIT: feature='Data_Transmission_Frequency', threshold=25.141677, samples=7598, impurity=0.000263
[2026-01-31 18:36:13]             LEAF: samples=7593, class=0, values=[1. 0.]
[2026-01-31 18:36:13]             SPLIT: feature='Route_Request_Frequency', threshold=13.826897, samples=5, impurity=0.320000
[2026-01-31 18:36:13]               LEAF: samples=4, class=0, values=[1. 0.]
[2026-01-31 18:36:13]               LEAF: samples=1, class=1, values=[0. 1.]
[2026-01-31 18:36:13]           SPLIT: feature='CPU_Usage', threshold=58.060781, samples=3, impurity=0.444444
[2026-01-31 18:36:13]             LEAF: samples=1, class=0, values=[1. 0.]
[2026-01-31 18:36:13]             LEAF: samples=2, class=1, values=[0. 1.]
[2026-01-31 18:36:13]         LEAF: samples=2, class=1, values=[0. 1.]
[2026-01-31 18:36:13]       LEAF: samples=5, class=1, values=[0. 1.]
[2026-01-31 18:36:13]     SPLIT: feature='Data_Throughput', threshold=89.443604, samples=41, impurity=0.092802
[2026-01-31 18:36:13]       LEAF: samples=39, class=1, values=[0. 1.]
[2026-01-31 18:36:13]       LEAF: samples=2, class=0, values=[1. 0.]
[2026-01-31 18:36:13]   SPLIT: feature='Data_Throughput', threshold=75.173611, samples=351, impurity=0.055357
[2026-01-31 18:36:13]     LEAF: samples=340, class=1, values=[0. 1.]
[2026-01-31 18:36:13]     SPLIT: feature='Data_Transmission_Frequency', threshold=21.560749, samples=11, impurity=0.165289
[2026-01-31 18:36:13]       LEAF: samples=10, class=0, values=[1. 0.]
[2026-01-31 18:36:13]       LEAF: samples=1, class=1, values=[0. 1.]
[2026-01-31 18:36:13] 
================================================================================
[2026-01-31 18:36:13] Feature Importance:
[2026-01-31 18:36:13] ================================================================================
[2026-01-31 18:36:13]   Error_Rate: 0.842579
[2026-01-31 18:36:13]   Energy_Consumption_Rate: 0.099186
[2026-01-31 18:36:13]   Data_Throughput: 0.028865
[2026-01-31 18:36:13]   Packet_Drop_Rate: 0.013451
[2026-01-31 18:36:13]   Data_Transmission_Frequency: 0.008375
[2026-01-31 18:36:13]   Route_Request_Frequency: 0.005748
[2026-01-31 18:36:13]   CPU_Usage: 0.001797
[2026-01-31 18:36:13]   Packet_Rate: 0.000000
[2026-01-31 18:36:13]   Memory_Usage: 0.000000
[2026-01-31 18:36:13]   Data_Reception_Frequency: 0.000000
[2026-01-31 18:36:13]   Number_of_Neighbors: 0.000000
[2026-01-31 18:36:13]   Route_Reply_Frequency: 0.000000
[2026-01-31 18:36:13]   Battery_Level: 0.000000
[2026-01-31 18:36:13]   SNR: 0.000000
[2026-01-31 18:36:13]   Signal_Strength: 0.000000
[2026-01-31 18:36:13]   Packet_Duplication_Rate: 0.000000
[2026-01-31 18:36:13]   Bandwidth: 0.000000
[2026-01-31 18:36:13] 
================================================================================
[2026-01-31 18:36:13] Making predictions...
[2026-01-31 18:36:13] ================================================================================
[2026-01-31 18:36:13] 
================================================================================
[2026-01-31 18:36:13] Calculating Metrics...
[2026-01-31 18:36:13] ================================================================================
[2026-01-31 18:36:13] 
Training Set Metrics:
[2026-01-31 18:36:13]   Accuracy:  1.000000
[2026-01-31 18:36:13]   Precision: 1.000000
[2026-01-31 18:36:13]   Recall:    1.000000
[2026-01-31 18:36:13]   F1 Score:  1.000000
[2026-01-31 18:36:13]   ROC-AUC:   1.000000
[2026-01-31 18:36:13]   Avg Precision: 1.000000
[2026-01-31 18:36:13]   Confusion Matrix:
[2026-01-31 18:36:13]     [[7610    0]
 [   0  390]]
[2026-01-31 18:36:13] 
Test Set Metrics:
[2026-01-31 18:36:13]   Accuracy:  0.999500
[2026-01-31 18:36:13]   Precision: 0.989796
[2026-01-31 18:36:13]   Recall:    1.000000
[2026-01-31 18:36:13]   F1 Score:  0.994872
[2026-01-31 18:36:13]   ROC-AUC:   0.999737
[2026-01-31 18:36:13]   Avg Precision: 0.989796
[2026-01-31 18:36:13]   Confusion Matrix:
[2026-01-31 18:36:13]     [[1902    1]
 [   0   97]]
[2026-01-31 18:36:13] 
Classification Report (Test Set):
[2026-01-31 18:36:13]               precision    recall  f1-score   support

      Benign       1.00      1.00      1.00      1903
   Malicious       0.99      1.00      0.99        97

    accuracy                           1.00      2000
   macro avg       0.99      1.00      1.00      2000
weighted avg       1.00      1.00      1.00      2000

[2026-01-31 18:36:13] 
✓ Results saved to: /Users/raj/Supervised_IDS/experiments/sensornetguard/decision_tree_experiment/results/results_20260131_183611.json