[2026-01-31 16:12:48] Reading data...
[2026-01-31 16:12:48]   Train file: /Users/raj/Supervised_IDS/data/farm-flow-silver/Farm-Flow_Train_Binary.csv
[2026-01-31 16:12:48]   Test file: /Users/raj/Supervised_IDS/data/farm-flow-silver/Farm-Flow_Test_Binary.csv
[2026-01-31 16:12:48] Loading training data (this may take a while for large files)...
[2026-01-31 16:12:50]   Training data shape: (561081, 31)
[2026-01-31 16:12:50] Loading test data...
[2026-01-31 16:12:50]   Test data shape: (3545, 31)
[2026-01-31 16:12:50] Found 30 feature columns
[2026-01-31 16:12:50] 
Handling missing values...
[2026-01-31 16:12:50]   Training missing values: 0
[2026-01-31 16:12:50]   Test missing values: 0
[2026-01-31 16:12:50] 
Checking for infinite values...
[2026-01-31 16:12:50]   Training infinite values: 0
[2026-01-31 16:12:50]   Test infinite values: 0
[2026-01-31 16:12:50] 
Data Summary:
[2026-01-31 16:12:50]   Training set: 561,081 samples
[2026-01-31 16:12:50]   Test set: 3,545 samples
[2026-01-31 16:12:50]   Training class distribution: {0: 284880, 1: 276201}
[2026-01-31 16:12:50]   Test class distribution: {0: 1774, 1: 1771}
[2026-01-31 16:12:50] 
================================================================================
[2026-01-31 16:12:50] Feature Sanity Checks
[2026-01-31 16:12:50] ================================================================================
[2026-01-31 16:12:50] Checking for constant features (zero variance)...
[2026-01-31 16:12:50] Checking for near-constant features (low variance)...
[2026-01-31 16:12:50]   Dropping near-constant feature: fwd_pkts_payload.tot (variance: 1.40e-26)
[2026-01-31 16:12:50]   Dropping near-constant feature: fwd_pkts_payload.avg (variance: 4.56e-29)
[2026-01-31 16:12:50]   Dropping near-constant feature: flow_pkts_payload.tot (variance: 1.65e-26)
[2026-01-31 16:12:50]   Dropping near-constant feature: flow_pkts_payload.avg (variance: 1.30e-29)
[2026-01-31 16:12:50] Checking for features with excessive missing values...
[2026-01-31 16:12:50] 
Dropping 4 problematic features:
[2026-01-31 16:12:50]   - fwd_pkts_payload.tot
[2026-01-31 16:12:50]   - fwd_pkts_payload.avg
[2026-01-31 16:12:50]   - flow_pkts_payload.tot
[2026-01-31 16:12:50]   - flow_pkts_payload.avg
[2026-01-31 16:12:50] 
Feature count: 30 → 26 (dropped 4)
[2026-01-31 16:12:50] 
================================================================================
[2026-01-31 16:12:50] Training Decision Tree Classifier...
[2026-01-31 16:12:50] ================================================================================
[2026-01-31 16:12:50] Tree Parameters:
[2026-01-31 16:12:50]   criterion: gini
[2026-01-31 16:12:50]   splitter: best
[2026-01-31 16:12:50]   max_depth: None
[2026-01-31 16:12:50]   min_samples_split: 2
[2026-01-31 16:12:50]   min_samples_leaf: 1
[2026-01-31 16:12:50]   min_weight_fraction_leaf: 0.0
[2026-01-31 16:12:50]   max_features: None
[2026-01-31 16:12:50]   random_state: 42
[2026-01-31 16:12:50]   max_leaf_nodes: None
[2026-01-31 16:12:50]   min_impurity_decrease: 0.0
[2026-01-31 16:12:50]   class_weight: None
[2026-01-31 16:12:50]   ccp_alpha: 0.0
[2026-01-31 16:12:50] 
Training tree (this may take a while for full convergence)...
[2026-01-31 16:12:51] ✓ Tree training completed!
[2026-01-31 16:12:51]   Tree depth: 9
[2026-01-31 16:12:51]   Number of nodes: 41
[2026-01-31 16:12:51]   Number of leaves: 21
[2026-01-31 16:12:51] 
================================================================================
[2026-01-31 16:12:51] Saving model artifact...
[2026-01-31 16:12:51] ================================================================================
[2026-01-31 16:12:51] ✓ Model saved to: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/models/decision_tree_model_20260131_161248.joblib
[2026-01-31 16:12:51] 
================================================================================
[2026-01-31 16:12:51] Creating tree visualization...
[2026-01-31 16:12:51] ================================================================================
[2026-01-31 16:12:52]   Saved PNG: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/visualizations/tree_visualization_20260131_161248.png
[2026-01-31 16:12:52]   Saved SVG: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/visualizations/tree_visualization_20260131_161248.svg
[2026-01-31 16:12:52]   Saved PDF: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/visualizations/tree_visualization_20260131_161248.pdf
[2026-01-31 16:12:52] ✓ Tree visualization completed!
[2026-01-31 16:12:52]   Note: graphviz not installed, skipping graphviz export
[2026-01-31 16:12:52] 
================================================================================
[2026-01-31 16:12:52] Extracting tree structure and splits...
[2026-01-31 16:12:52] ================================================================================
[2026-01-31 16:12:52] 
Tree Structure (first 100 lines):
[2026-01-31 16:12:52] |--- orig_pkts <= 0.17
|   |--- bwd_pkts_payload.tot <= 0.95
|   |   |--- data_pkts_difference <= 1.14
|   |   |   |--- bwd_pkts_payload.tot <= 0.24
|   |   |   |   |--- data_pkts_difference <= 0.06
|   |   |   |   |   |--- fwd_iat.avg <= -0.17
|   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |--- fwd_iat.avg >  -0.17
|   |   |   |   |   |   |--- fwd_pkts_per_sec <= 0.01
|   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |   |--- fwd_pkts_per_sec >  0.01
|   |   |   |   |   |   |   |--- orig_ip_bytes <= -0.17
|   |   |   |   |   |   |   |   |--- traffic <= 4.50
|   |   |   |   |   |   |   |   |   |--- class: 0
|   |   |   |   |   |   |   |   |--- traffic >  4.50
|   |   |   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |   |   |--- orig_ip_bytes >  -0.17
|   |   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |--- data_pkts_difference >  0.06
|   |   |   |   |   |--- traffic <= 3.50
|   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |--- traffic >  3.50
|   |   |   |   |   |   |--- resp_ip_bytes <= 0.25
|   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |   |--- resp_ip_bytes >  0.25
|   |   |   |   |   |   |   |--- class: 0
|   |   |   |--- bwd_pkts_payload.tot >  0.24
|   |   |   |   |--- bwd_pkts_payload.avg <= 0.70
|   |   |   |   |   |--- resp_ip_bytes <= 0.25
|   |   |   |   |   |   |--- class: 1
|   |   |   |   |   |--- resp_ip_bytes >  0.25
|   |   |   |   |   |   |--- orig_ip_bytes <= -0.16
|   |   |   |   |   |   |   |--- class: 0
|   |   |   |   |   |   |--- orig_ip_bytes >  -0.16
|   |   |   |   |   |   |   |--- class: 1
|   |   |   |   |--- bwd_pkts_payload.avg >  0.70
|   |   |   |   |   |--- class: 1
|   |   |--- data_pkts_difference >  1.14
|   |   |   |--- traffic <= 3.00
|   |   |   |   |--- class: 1
|   |   |   |--- traffic >  3.00
|   |   |   |   |--- class: 0
|   |--- bwd_pkts_payload.tot >  0.95
|   |   |--- orig_ip_bytes <= -0.20
|   |   |   |--- traffic <= 4.50
|   |   |   |   |--- traffic <= 3.50
|   |   |   |   |   |--- class: 1
|   |   |   |   |--- traffic >  3.50
|   |   |   |   |   |--- class: 0
|   |   |   |--- traffic >  4.50
|   |   |   |   |--- class: 1
|   |   |--- orig_ip_bytes >  -0.20
|   |   |   |--- class: 1
|--- orig_pkts >  0.17
|   |--- traffic <= 3.50
|   |   |--- class: 1
|   |--- traffic >  3.50
|   |   |--- traffic <= 4.50
|   |   |   |--- class: 0
|   |   |--- traffic >  4.50
|   |   |   |--- class: 1

[2026-01-31 16:12:52] 
Full tree structure saved to: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/logs/tree_structure_20260131_161248.txt
[2026-01-31 16:12:52] 
================================================================================
[2026-01-31 16:12:52] Detailed Split Information:
[2026-01-31 16:12:52] ================================================================================
[2026-01-31 16:12:52] SPLIT: feature='orig_pkts', threshold=0.168970, samples=561081, impurity=0.499880
[2026-01-31 16:12:52]   SPLIT: feature='bwd_pkts_payload.tot', threshold=0.949274, samples=258141, impurity=0.014024
[2026-01-31 16:12:52]     SPLIT: feature='data_pkts_difference', threshold=1.138000, samples=255859, impurity=0.005861
[2026-01-31 16:12:52]       SPLIT: feature='bwd_pkts_payload.tot', threshold=0.241789, samples=255740, impurity=0.005039
[2026-01-31 16:12:52]         SPLIT: feature='data_pkts_difference', threshold=0.062810, samples=254662, impurity=0.003379
[2026-01-31 16:12:52]           SPLIT: feature='fwd_iat.avg', threshold=-0.166122, samples=247386, impurity=0.001293
[2026-01-31 16:12:52]             LEAF: samples=237301, class=1, values=[0. 1.]
[2026-01-31 16:12:52]             SPLIT: feature='fwd_pkts_per_sec', threshold=0.007017, samples=10085, impurity=0.031227
[2026-01-31 16:12:52]               LEAF: samples=9879, class=1, values=[0. 1.]
[2026-01-31 16:12:52]               SPLIT: feature='orig_ip_bytes', threshold=-0.174332, samples=206, impurity=0.346875
[2026-01-31 16:12:52]                 SPLIT: feature='traffic', threshold=4.500000, samples=175, impurity=0.156735
[2026-01-31 16:12:52]                   LEAF: samples=160, class=0, values=[1. 0.]
[2026-01-31 16:12:52]                   LEAF: samples=15, class=1, values=[0. 1.]
[2026-01-31 16:12:52]                 LEAF: samples=31, class=1, values=[0. 1.]
[2026-01-31 16:12:52]           SPLIT: feature='traffic', threshold=3.500000, samples=7276, impurity=0.071717
[2026-01-31 16:12:52]             LEAF: samples=6940, class=1, values=[0. 1.]
[2026-01-31 16:12:52]             SPLIT: feature='resp_ip_bytes', threshold=0.247892, samples=336, impurity=0.312057
[2026-01-31 16:12:52]               LEAF: samples=65, class=1, values=[0. 1.]
[2026-01-31 16:12:52]               LEAF: samples=271, class=0, values=[1. 0.]
[2026-01-31 16:12:52]         SPLIT: feature='bwd_pkts_payload.avg', threshold=0.703954, samples=1078, impurity=0.319331
[2026-01-31 16:12:52]           SPLIT: feature='resp_ip_bytes', threshold=0.247892, samples=236, impurity=0.162130
[2026-01-31 16:12:52]             LEAF: samples=13, class=1, values=[0. 1.]
[2026-01-31 16:12:52]             SPLIT: feature='orig_ip_bytes', threshold=-0.164584, samples=223, impurity=0.069175
[2026-01-31 16:12:52]               LEAF: samples=215, class=0, values=[1. 0.]
[2026-01-31 16:12:52]               LEAF: samples=8, class=1, values=[0. 1.]
[2026-01-31 16:12:52]           LEAF: samples=842, class=1, values=[0. 1.]
[2026-01-31 16:12:52]       SPLIT: feature='traffic', threshold=3.000000, samples=119, impurity=0.194619
[2026-01-31 16:12:52]         LEAF: samples=13, class=1, values=[0. 1.]
[2026-01-31 16:12:52]         LEAF: samples=106, class=0, values=[1. 0.]
[2026-01-31 16:12:52]     SPLIT: feature='orig_ip_bytes', threshold=-0.198702, samples=2282, impurity=0.498118
[2026-01-31 16:12:52]       SPLIT: feature='traffic', threshold=4.500000, samples=1306, impurity=0.295122
[2026-01-31 16:12:52]         SPLIT: feature='traffic', threshold=3.500000, samples=1079, impurity=0.014719
[2026-01-31 16:12:52]           LEAF: samples=8, class=1, values=[0. 1.]
[2026-01-31 16:12:52]           LEAF: samples=1071, class=0, values=[1. 0.]
[2026-01-31 16:12:52]         LEAF: samples=227, class=1, values=[0. 1.]
[2026-01-31 16:12:52]       LEAF: samples=976, class=1, values=[0. 1.]
[2026-01-31 16:12:52]   SPLIT: feature='traffic', threshold=3.500000, samples=302940, impurity=0.122651
[2026-01-31 16:12:52]     LEAF: samples=11393, class=1, values=[0. 1.]
[2026-01-31 16:12:52]     SPLIT: feature='traffic', threshold=4.500000, samples=291547, impurity=0.056545
[2026-01-31 16:12:52]       LEAF: samples=283057, class=0, values=[1. 0.]
[2026-01-31 16:12:52]       LEAF: samples=8490, class=1, values=[0. 1.]
[2026-01-31 16:12:52] 
(Note: Only first 10 levels shown in detail. Full tree structure saved to file.)
[2026-01-31 16:12:52] 
================================================================================
[2026-01-31 16:12:52] Feature Importance (Top 20):
[2026-01-31 16:12:52] ================================================================================
[2026-01-31 16:12:52]   orig_pkts: 0.854616
[2026-01-31 16:12:52]   traffic: 0.135517
[2026-01-31 16:12:52]   bwd_pkts_payload.tot: 0.003808
[2026-01-31 16:12:52]   orig_ip_bytes: 0.002891
[2026-01-31 16:12:52]   bwd_pkts_payload.avg: 0.001091
[2026-01-31 16:12:52]   fwd_pkts_per_sec: 0.000868
[2026-01-31 16:12:52]   data_pkts_difference: 0.000737
[2026-01-31 16:12:52]   resp_ip_bytes: 0.000455
[2026-01-31 16:12:52]   fwd_iat.avg: 0.000017
[2026-01-31 16:12:52]   pkts_difference: 0.000000
[2026-01-31 16:12:52]   flow_iat.avg: 0.000000
[2026-01-31 16:12:52]   flow_iat.tot: 0.000000
[2026-01-31 16:12:52]   bwd_iat.avg: 0.000000
[2026-01-31 16:12:52]   bwd_iat.tot: 0.000000
[2026-01-31 16:12:52]   fwd_iat.tot: 0.000000
[2026-01-31 16:12:52]   missed_bytes: 0.000000
[2026-01-31 16:12:52]   bwd_header_size_max: 0.000000
[2026-01-31 16:12:52]   bwd_header_size_tot: 0.000000
[2026-01-31 16:12:52]   fwd_header_size_max: 0.000000
[2026-01-31 16:12:52]   fwd_header_size_min: 0.000000
[2026-01-31 16:12:52] 
================================================================================
[2026-01-31 16:12:52] Making predictions...
[2026-01-31 16:12:52] ================================================================================
[2026-01-31 16:12:52] 
================================================================================
[2026-01-31 16:12:52] Calculating Metrics...
[2026-01-31 16:12:52] ================================================================================
[2026-01-31 16:12:52] 
Training Set Metrics:
[2026-01-31 16:12:52]   Accuracy:  1.000000
[2026-01-31 16:12:52]   Precision: 1.000000
[2026-01-31 16:12:52]   Recall:    1.000000
[2026-01-31 16:12:52]   F1 Score:  1.000000
[2026-01-31 16:12:52]   ROC-AUC:   1.000000
[2026-01-31 16:12:52]   Avg Precision: 1.000000
[2026-01-31 16:12:52]   Confusion Matrix:
[2026-01-31 16:12:52]     [[284880      0]
 [     0 276201]]
[2026-01-31 16:12:52] 
Test Set Metrics:
[2026-01-31 16:12:52]   Accuracy:  1.000000
[2026-01-31 16:12:52]   Precision: 1.000000
[2026-01-31 16:12:52]   Recall:    1.000000
[2026-01-31 16:12:52]   F1 Score:  1.000000
[2026-01-31 16:12:52]   ROC-AUC:   1.000000
[2026-01-31 16:12:52]   Avg Precision: 1.000000
[2026-01-31 16:12:52]   Confusion Matrix:
[2026-01-31 16:12:52]     [[1774    0]
 [   0 1771]]
[2026-01-31 16:12:52] 
Classification Report (Test Set):
[2026-01-31 16:12:52]               precision    recall  f1-score   support

      Benign       1.00      1.00      1.00      1774
      Attack       1.00      1.00      1.00      1771

    accuracy                           1.00      3545
   macro avg       1.00      1.00      1.00      3545
weighted avg       1.00      1.00      1.00      3545

[2026-01-31 16:12:52] 
✓ Results saved to: /Users/raj/Supervised_IDS/experiments/farmflow/decision_tree_experiment/results/results_20260131_161248.json